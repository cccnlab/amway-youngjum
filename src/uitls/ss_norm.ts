// Age group 1 for age range 50 - 65 and group 2 for age > 65
const MU1 = 57616.27906976744
const SD1 = 15862.90730021276
const MU2 = 54475.935828877
const SD2 = 18086.93233941089

const VAL1_201_PROB = [0.        , 0.        , 0.        , 0.        , 0.        ,
  0.        , 0.        , 0.        , 0.        , 0.        ,
  0.00581395, 0.00581395, 0.00581395, 0.00581395, 0.00581395,
  0.00581395, 0.00581395, 0.00581395, 0.00581395, 0.00581395,
  0.00581395, 0.00581395, 0.00581395, 0.00581395, 0.00581395,
  0.00581395, 0.00581395, 0.01162791, 0.01162791, 0.01162791,
  0.01162791, 0.01162791, 0.01162791, 0.01162791, 0.01162791,
  0.01744186, 0.01744186, 0.01744186, 0.01744186, 0.01744186,
  0.02325581, 0.02325581, 0.02325581, 0.02325581, 0.02325581,
  0.02325581, 0.02325581, 0.02325581, 0.02325581, 0.02325581,
  0.02906977, 0.02906977, 0.04069767, 0.04069767, 0.04651163,
  0.05232558, 0.05232558, 0.06976744, 0.06976744, 0.06976744,
  0.08139535, 0.08139535, 0.0872093 , 0.0872093 , 0.0872093 ,
  0.09302326, 0.09302326, 0.10465116, 0.10465116, 0.12209302,
  0.15697674, 0.15697674, 0.18604651, 0.18604651, 0.20930233,
  0.22093023, 0.22093023, 0.23837209, 0.23837209, 0.25581395,
  0.27906977, 0.27906977, 0.29651163, 0.29651163, 0.33139535,
  0.34302326, 0.34302326, 0.38953488, 0.38953488, 0.4244186 ,
  0.44186047, 0.44186047, 0.47674419, 0.47674419, 0.49418605,
  0.52906977, 0.52906977, 0.55813953, 0.55813953, 0.60465116,
  0.61627907, 0.61627907, 0.62209302, 0.62209302, 0.65116279,
  0.66860465, 0.66860465, 0.68604651, 0.68604651, 0.70348837,
  0.73837209, 0.73837209, 0.75      , 0.75      , 0.76744186,
  0.78488372, 0.78488372, 0.78488372, 0.78488372, 0.80232558,
  0.80232558, 0.80232558, 0.81976744, 0.81976744, 0.81976744,
  0.8372093 , 0.8372093 , 0.8372093 , 0.8372093 , 0.85465116,
  0.86627907, 0.86627907, 0.87790698, 0.87790698, 0.88953488,
  0.91860465, 0.91860465, 0.94186047, 0.94186047, 0.94767442,
  0.95930233, 0.95930233, 0.95930233, 0.95930233, 0.96511628,
  0.97674419, 0.97674419, 0.97674419, 0.97674419, 0.98837209,
  0.98837209, 0.98837209, 0.98837209, 0.98837209, 0.99418605,
  0.99418605, 0.99418605, 0.99418605, 0.99418605, 0.99418605,
  0.99418605, 0.99418605, 0.99418605, 0.99418605, 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        ]

const VAL2_201_PROB = [0.        , 0.        , 0.        , 0.        , 0.00534759,
  0.00534759, 0.00534759, 0.01069519, 0.01069519, 0.01069519,
  0.01604278, 0.01604278, 0.01604278, 0.01604278, 0.02673797,
  0.02673797, 0.02673797, 0.03208556, 0.03208556, 0.03208556,
  0.03208556, 0.03208556, 0.03208556, 0.03208556, 0.03208556,
  0.03208556, 0.03208556, 0.03208556, 0.03208556, 0.03208556,
  0.03743316, 0.03743316, 0.03743316, 0.03743316, 0.03743316,
  0.03743316, 0.03743316, 0.04278075, 0.04278075, 0.05882353,
  0.05882353, 0.05882353, 0.05882353, 0.05882353, 0.05882353,
  0.05882353, 0.05882353, 0.06951872, 0.06951872, 0.06951872,
  0.07486631, 0.07486631, 0.0802139 , 0.0802139 , 0.09090909,
  0.10695187, 0.10695187, 0.10695187, 0.10695187, 0.12299465,
  0.12299465, 0.12299465, 0.12834225, 0.12834225, 0.13368984,
  0.14438503, 0.14438503, 0.1657754 , 0.1657754 , 0.17647059,
  0.20855615, 0.20855615, 0.22459893, 0.22459893, 0.23529412,
  0.26203209, 0.26203209, 0.28342246, 0.28342246, 0.29946524,
  0.32620321, 0.32620321, 0.35294118, 0.35294118, 0.39572193,
  0.41176471, 0.41176471, 0.45454545, 0.45454545, 0.48128342,
  0.54010695, 0.54010695, 0.54010695, 0.54010695, 0.56149733,
  0.58823529, 0.58823529, 0.60962567, 0.60962567, 0.65775401,
  0.67914439, 0.67914439, 0.68983957, 0.68983957, 0.72192513,
  0.74331551, 0.74331551, 0.77005348, 0.77005348, 0.79144385,
  0.80748663, 0.80748663, 0.80748663, 0.80748663, 0.82352941,
  0.83957219, 0.83957219, 0.85561497, 0.85561497, 0.86096257,
  0.87700535, 0.87700535, 0.87700535, 0.87700535, 0.88235294,
  0.89839572, 0.89839572, 0.89839572, 0.89839572, 0.90909091,
  0.9197861 , 0.9197861 , 0.9197861 , 0.9197861 , 0.9197861 ,
  0.92513369, 0.92513369, 0.92513369, 0.92513369, 0.93048128,
  0.93048128, 0.93048128, 0.93048128, 0.93048128, 0.93582888,
  0.93582888, 0.93582888, 0.93582888, 0.93582888, 0.95187166,
  0.95187166, 0.95187166, 0.95187166, 0.95187166, 0.95187166,
  0.96791444, 0.96791444, 0.97860963, 0.97860963, 0.98395722,
  0.98930481, 0.98930481, 0.98930481, 0.98930481, 0.99465241,
  0.99465241, 0.99465241, 0.99465241, 0.99465241, 0.99465241,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        , 1.        , 1.        , 1.        , 1.        ,
  1.        ]

function ageGroup1Prob (score: number) {
  const probIndex = Math.min(Math.floor(score / 600),200)
  return Math.round(VAL1_201_PROB[probIndex]*100)
}

function ageGroup2Prob (score: number) {
  const probIndex = Math.min(Math.floor(score / 600),200)
  return Math.round(VAL2_201_PROB[probIndex]*100)
}

function SS_Percentile (score: number, age: number) {
  return (age > 65) ? ageGroup2Prob(score) : ageGroup1Prob(score)
}

function SS_D_PRIME (score: number, age: number) {

  const mu = age > 65 ? MU2 : MU1
  const sd = age > 65 ? SD2 : SD1
  return (score - mu) / sd
}

export { SS_D_PRIME, SS_Percentile }

